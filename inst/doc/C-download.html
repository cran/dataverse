<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />


<meta name="date" content="2025-05-20" />

<title>3. Data Download</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">3. Data Download</h1>
<h4 class="date">2025-05-20</h4>



<p>This vignette shows how to download data from Dataverse using the
dataverse package. We’ll focus on a Dataverse repository that contains
supplemental files for the book <em>Political Analysis Using R</em>
(2015), which is stored at Harvard’s Dataverse Server (<a href="https://dataverse.harvard.edu" class="uri">https://dataverse.harvard.edu</a>).</p>
<p>The Dataverse entry for this study is persistently retrievable by a
“Digital Object Identifier (DOI)”: <a href="https://doi.org/10.7910/DVN/ARKOTI" class="uri">https://doi.org/10.7910/DVN/ARKOTI</a> and the citation on
the Dataverse Page includes a “<a href="https://guides.dataverse.org/en/latest/developers/unf/index.html">Universal
Numeric Fingerprint (UNF)</a>”:
<code>UNF:6:+itU9hcUJ8I9E0Kqv8HWHg==</code>, which provides a versioned,
multi-file hash for the entire study, which contains 32 files.</p>
<p>The following examples will draw from the Harvard Dataverse, so it is
convenient to set this as a default environment variable.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">Sys.setenv</span>(<span class="st">&quot;DATAVERSE_SERVER&quot;</span> <span class="ot">=</span> <span class="st">&quot;dataverse.harvard.edu&quot;</span>)</span></code></pre></div>
<p>This is equivalent to setting
<code>server = &quot;dataverse.harvard.edu&quot;</code> in every
<code>dataverse</code> function each time. Note that if you set an
environment variable like the above, that operation is necessary to make
your code reproducible on a different machine.</p>
<p>For downloading a public dataset, <em>no API Key is needed</em>.</p>
<div id="retrieving-plain-text-data" class="section level2">
<h2>Retrieving Plain-Text Data</h2>
<p>We will download public data files and examine them directly in R
using the <strong>dataverse</strong> package.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;dataverse&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;tibble&quot;</span>) <span class="co"># to see dataframes in tidyverse-form</span></span></code></pre></div>
<p>First, we retrieve a plain-text file like this dataset on electricity
consumption by <a href="https://doi.org/10.7910/DVN/ARKOTI/GN1MRT">Wakiyama et
al. (2014)</a>. Taking the file name and dataset DOI from this
entry,</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>energy <span class="ot">&lt;-</span> <span class="fu">get_dataframe_by_name</span>(</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">&quot;comprehensiveJapanEnergy.tab&quot;</span>,</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  <span class="at">dataset =</span> <span class="st">&quot;10.7910/DVN/ARKOTI&quot;</span>, </span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  <span class="at">server =</span> <span class="st">&quot;dataverse.harvard.edu&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">head</span>(energy)</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="do">## # A tibble: 6 × 10</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="do">##    time date  dummy  temp temp2      all    large    house    kepco    tepco</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="do">##   &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="do">## 1     1 8-Jan     0   5.9  34.8 95792389 35194957 26190714 13357735 26960899</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="do">## 2     2 8-Feb     0   5.5  30.3 95156901 35322031 24224097 13315027 27189705</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="do">## 3     3 8-Mar     0  10.7 114.  91034047 36474192 21391965 12805831 24495519</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="do">## 4     4 8-Apr     0  14.7 216.  84087552 34949622 18494473 11494328 23540356</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="do">## 5     5 8-May     0  18.5 342.  82742929 35417089 17923760 11589061 22848737</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="do">## 6     6 8-Jun     0  21.3 454.  82180013 36692291 15205229 11360771 22487441</span></span></code></pre></div>
<p>These <code>get_dataframe_*</code> functions, introduced in v0.3.0,
directly read in the data into a R environment through whatever R
function supplied by <code>.f</code>. The default of the
<code>get_dataframe_*</code> functions is to read in such data by
<code>readr::read_tsv()</code>. The <code>.f</code> function can be
modified to modify the read-in settings. For example, the following
modification is a base-R equivalent to read in the ingested data.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>energy <span class="ot">&lt;-</span> <span class="fu">get_dataframe_by_name</span>(</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">&quot;comprehensiveJapanEnergy.tab&quot;</span>,</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  <span class="at">dataset =</span> <span class="st">&quot;10.7910/DVN/ARKOTI&quot;</span>, </span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  <span class="at">server =</span> <span class="st">&quot;dataverse.harvard.edu&quot;</span>,</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  <span class="at">.f =</span> <span class="cf">function</span>(x) <span class="fu">read.delim</span>(x, <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>))</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="fu">head</span>(energy)</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="do">##   time  date dummy temp temp2      all    large    house    kepco    tepco</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="do">## 1    1 8-Jan     0  5.9  34.8 95792389 35194957 26190714 13357735 26960899</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="do">## 2    2 8-Feb     0  5.5  30.3 95156901 35322031 24224097 13315027 27189705</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="do">## 3    3 8-Mar     0 10.7 114.5 91034047 36474192 21391965 12805831 24495519</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="do">## 4    4 8-Apr     0 14.7 216.1 84087552 34949622 18494473 11494328 23540356</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="do">## 5    5 8-May     0 18.5 342.3 82742929 35417089 17923760 11589061 22848737</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="do">## 6    6 8-Jun     0 21.3 453.7 82180013 36692291 15205229 11360771 22487441</span></span></code></pre></div>
<p>The dataverse package can also download datasets that are
<em>drafts</em> (i.e. versions not released publicly), as long as the
user of the dataset provides their appropriate DATAVERSE_KEY. Users may
need to modify the metadata of a datafile, such as adding a descriptive
label, for the data downloading to work properly in this case. This is
because the the file identifier UNF, which the read function relies on,
may only appear after metadata has been added.</p>
</div>
<div id="caching-large-datasets" class="section level2">
<h2>Caching large datasets</h2>
<p>As of v0.3.15, datasets are <em>cached</em> on your computer if the
user specifies a version of the dataset. The next time the code is run,
the function will read from the cache rather than re-downloading from
the Dataverse. Version specification can be done, e.g., by setting
<code>version = &quot;3&quot;</code> for V3, for instance. This is useful to avoid
re-downloading the identical dataset every time, especially if they take
some time to download. To turn off or view the settings of caching, see
<code>cache_dataset()</code>.</p>
</div>
<div id="retrieving-custom-data-formats-rds-stata-spss" class="section level2">
<h2>Retrieving Custom Data Formats (RDS, Stata, SPSS)</h2>
<p>If a file is displayed on dataverse as a <code>.tab</code> file like
the survey data by <a href="https://doi.org/10.7910/DVN/ARKOTI/A8YRMP">Alvarez et
al. (2013)</a>, it is likely that Dataverse <a href="https://guides.dataverse.org/en/latest/user/tabulardataingest/index.html">ingested</a>
the file to a plain-text, tab-delimited format.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>argentina_tab <span class="ot">&lt;-</span> <span class="fu">get_dataframe_by_name</span>(</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">&quot;alpl2013.tab&quot;</span>,</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>  <span class="at">dataset =</span> <span class="st">&quot;10.7910/DVN/ARKOTI&quot;</span>,</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>  <span class="at">server =</span> <span class="st">&quot;dataverse.harvard.edu&quot;</span>)</span></code></pre></div>
<p>However, ingested files may not retain important dataset attributes.
For example, Stata and SPSS datasets encode value labels on to numeric
values. Factor variables in R dataframes encode levels, not only labels.
A plain-text ingested file will discard such information. For example,
the <code>polling_place</code> variable in this data is only given by
numbers, although the original data labelled these numbers with
informative values.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">str</span>(argentina_tab<span class="sc">$</span>polling_place)</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="do">## num [1:1475] 31 31 31 31 31 31 31 31 31 31 ...</span></span></code></pre></div>
<p>When ingesting, Dataverse retains a <code>original</code> version
that retains these attributes but may not be readable in some platforms.
The <code>get_dataframe_*</code> functions have an argument that can be
set to <code>original = TRUE</code>. In this case we know that
<code>alpl2013.tab</code> was originally a Stata dta file, so we can
run:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>argentina_dta <span class="ot">&lt;-</span> <span class="fu">get_dataframe_by_name</span>(</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">&quot;alpl2013.tab&quot;</span>,</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  <span class="at">dataset =</span> <span class="st">&quot;10.7910/DVN/ARKOTI&quot;</span>,</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  <span class="at">server =</span> <span class="st">&quot;dataverse.harvard.edu&quot;</span>,</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>  <span class="at">original =</span> <span class="cn">TRUE</span>,</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>  <span class="at">.f =</span> haven<span class="sc">::</span>read_dta)</span></code></pre></div>
<p>Now we see that labels are read in through <code>haven</code>’s
labelled variables class:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">str</span>(argentina_dta<span class="sc">$</span>polling_place)</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="do">##  dbl+lbl [1:1475] 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 3...</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="do">##  @ label       : chr &quot;polling_place&quot;</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="do">##  @ format.stata: chr &quot;%9.0g&quot;</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="do">##  @ labels      : Named num [1:37] 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="do">##   ..- attr(*, &quot;names&quot;)= chr [1:37] &quot;E.E.T.&quot; &quot;Escuela Juan Bautista Alberdi&quot; &quot;Escuela Juan Carlos DÃ¡valos&quot; &quot;Escuela Bernardino de Rivadavia&quot; ...</span></span></code></pre></div>
<p>Users should pick <code>.f</code> and <code>original</code> based on
their existing knowledge of the file. If the original file is a
<code>.sav</code> SPSS file, <code>.f</code> can be
<code>haven::read_sav</code>. If it is a <code>.Rds</code> file, use
<code>readRDS</code> or <code>readr::read_rds</code>. In fact, because
the raw data is read in as a binary, there is no limitation to the file
types <code>get_dataframe_*</code> can read in, as far as the dataverse
package is concerned.</p>
<p>There are two more ways to read in a dataframe other than
<code>get_dataframe_by_name()</code>.</p>
<ul>
<li><code>get_dataframe_by_doi()</code> takes in a file-specific DOI if
Dataverse contains one such as <a href="https://doi.org/10.7910/DVN/ARKOTI/IJPVOI" class="uri">https://doi.org/10.7910/DVN/ARKOTI/IJPVOI</a>. This removes
the necessity for users to set the <code>dataset</code> argument.</li>
<li><code>get_dataframe_by_id()</code> takes a numeric Dataverse
identification number. This identifier is an internal number and is not
prominently featured in the interface.</li>
</ul>
<p>In addition to visual inspection, we can compare the UNF signatures
for each dataset against what is reported by Dataverse to confirm that
we received the correct files.</p>
</div>
<div id="retrieving-metadata" class="section level2">
<h2>Retrieving Metadata</h2>
<p>We may also want to retrieve some basic metadata about the dataset.
The <code>get_dataset()</code> function lists all of the files in the
dataset along with a considerable amount of metadata about each. (Recall
that in Dataverse, <code>dataset</code> is a collection of files, not a
single file.) We can see a quick glance at these files using:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>dataset <span class="ot">&lt;-</span> <span class="fu">get_dataset</span>(<span class="st">&quot;doi:10.7910/DVN/ARKOTI&quot;</span>, <span class="at">server =</span> <span class="st">&quot;dataverse.harvard.edu&quot;</span>)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>dataset<span class="sc">$</span>files[<span class="fu">c</span>(<span class="st">&quot;filename&quot;</span>, <span class="st">&quot;contentType&quot;</span>)]</span></code></pre></div>
<p>This shows that there are indeed 32 files, a mix of .R code files and
tab- and comma-separated data files.</p>
<p>You can also retrieve more extensive metadata using
<code>dataset_metadata()</code>:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">str</span>(<span class="fu">dataset_metadata</span>(<span class="st">&quot;10.7910/DVN/ARKOTI&quot;</span>, <span class="at">server =</span> <span class="st">&quot;dataverse.harvard.edu&quot;</span>), </span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>    <span class="at">max.level =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="do">## List of 3</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="do">##  $ displayName: chr &quot;Citation Metadata&quot;</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="do">##  $ name       : chr &quot;citation&quot;</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="do">##  $ fields     :&#39;data.frame&#39;: 7 obs. of  4 variables:</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="do">##   ..$ typeName : chr [1:7] &quot;title&quot; &quot;author&quot; &quot;datasetContact&quot; &quot;dsDescription&quot; ...</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="do">##   ..$ multiple : logi [1:7] FALSE TRUE TRUE TRUE TRUE FALSE ...</span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="do">##   ..$ typeClass: chr [1:7] &quot;primitive&quot; &quot;compound&quot; &quot;compound&quot; &quot;compound&quot; ...</span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a><span class="do">##   ..$ value    :List of 7</span></span></code></pre></div>
</div>
<div id="retrieving-scripts-and-other-files" class="section level2">
<h2>Retrieving Scripts and Other Files</h2>
<p>If the file you want to retrieve is not data, you may want to use the
more primitive function, <code>get_file</code>, which gets the file data
as a raw binary file. See the help page examples of
<code>get_file()</code> that use the <code>base::writeBin()</code>
function for details on how to write and read these binary files
instead.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>code3 <span class="ot">&lt;-</span> <span class="fu">get_file</span>(<span class="st">&quot;chapter03.R&quot;</span>, <span class="st">&quot;doi:10.7910/DVN/ARKOTI&quot;</span>, <span class="at">server =</span> <span class="st">&quot;dataverse.harvard.edu&quot;</span>)</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="fu">writeBin</span>(code3, <span class="st">&quot;chapter03.R&quot;</span>)</span></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
